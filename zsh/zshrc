# p10k instant prompt, 应该放在 zshrc 的一开始
if [[ -r "${XDG_CACHE_HOME:-$HOME/.cache}/p10k-instant-prompt-${(%):-%n}.zsh" ]] {
  . "${XDG_CACHE_HOME:-$HOME/.cache}/p10k-instant-prompt-${(%):-%n}.zsh"
}

if [[ "$(uname -n)" == hpc-login* || "$(uname -n)" == gpu* || "$(uname -n)" == mngg* || "$(uname -n)" == g400* || "$(uname -n)" == ln01 ]] {
  # JuNest 初始化
  PATH=$PATH:$HOME/.junest/usr/bin_wrappers
  PATH=$PATH:$HOME/.local/share/junest/bin
}

# statically-linked zsh
if [[ "$(uname -n)" == ln01 || "$(uname -n)" == gpu* && "$(head -n 1 /etc/os-release)" == *Rocky* ]] {
  PATH=$PATH:$HOME/jnguan/code/source/zsh/bin
  FPATH=$FPATH:$HOME/jnguan/code/source/zsh/share/zsh/5.8/functions
}

# config 总目录
if [[ "$(uname -n)" == ln01 || "$(uname -n)" == gpu* && "$(head -n 1 /etc/os-release)" == *Rocky* ]] {
  CONFIG_HOME=$HOME/jnguan/code/config
} else {
  CONFIG_HOME=$HOME/code/config
}

# 一些环境变量
. $CONFIG_HOME/zsh/env.zsh

# 历史去重
setopt HIST_IGNORE_ALL_DUPS

# zim
. $CONFIG_HOME/zsh/zim.zsh

# 并行科技超算
if [[ "$(uname -n)" == paraai* ]] {
  . /home/bingxing2/apps/tools/modules/init/profile.sh
  module use /home/bingxing2/apps/modules/
  module load anaconda/2021.11
  module load nccl/2.17.1-1_cuda11.6
  module load cudnn/8.6.0.163_cuda11.x
  module load compilers/gcc/9.3.0
  module load compilers/cuda/11.6
}

# source 一下 zsh 的其他配置
. $CONFIG_HOME/zsh/alias.zsh
. $CONFIG_HOME/zsh/conda.zsh
. $CONFIG_HOME/zsh/p10k.zsh
